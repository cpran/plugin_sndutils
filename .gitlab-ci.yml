# This file is generated by GitLab CI
Run tests:
  script:
  - # Clear workspace, just in case
  - rm -rf ~/.praat-dir/plugin{utils,strutils,selection,testsimple,vieweach}
  - rm -rf ../plugin_{utils,strutils,selection,testsimple,vieweach}
  - # Clone all dependencies
  - git clone https://gitlab.com/cpran/plugin_utils.git      ../plugin_utils
  - git clone https://gitlab.com/cpran/plugin_strutils.git   ../plugin_strutils
  - git clone https://gitlab.com/cpran/plugin_testsimple.git ../plugin_testsimple
  - git clone https://gitlab.com/cpran/plugin_selection.git  ../plugin_selection
  - git clone https://gitlab.com/cpran/plugin_vieweach.git   ../plugin_vieweach
  - # Dependencies must exist in parent folder and preferences directory
  - cp -fa ../plugin_utils      ~/.praat-dir/plugin_utils
  - cp -fa ../plugin_strutils   ~/.praat-dir/plugin_strutils
  - cp -fa ../plugin_testsimple ~/.praat-dir/plugin_testsimple
  - cp -fa ../plugin_selection  ~/.praat-dir/plugin_selection
  - cp -fa ../plugin_vieweach   ~/.praat-dir/plugin_vieweach
  - cp -fa .                    ~/.praat-dir/plugin_sndutils
  - # Run tests
  - prove -v --exec "praat"
  - # Clear workspace
  - rm -rf ~/.praat-dir/plugin_testsimple ../plugin_testsimple
  - rm -rf ~/.praat-dir/plugin_utils      ../plugin_utils
  - rm -rf ~/.praat-dir/plugin_strutils   ../plugin_strutils
  - rm -rf ~/.praat-dir/plugin_selection  ../plugin_selection
  - rm -rf ~/.praat-dir/plugin_vieweach   ../plugin_vieweach
  - rm -rf ~/.praat-dir/plugin_sndutils
  tags:
    - cpran
  except:
  - tags